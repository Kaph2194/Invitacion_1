<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baby Shower Adelyne</title>
    <link rel="stylesheet" href="Css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
</head>
<body>

    <div id="overlay">
        <div class="overlay-content">
            <h1 class="font-cursive" style="font-size: 5em; color: #8e24aa;">Baby Shower</h1>
            <p>De nuestra hija Adelyne</p>
            <button onclick="abrirInvitacion()" class="btn-start">üì© ABRIR INVITACI√ìN</button>
        </div>
    </div>

    <audio id="musica-bebe" loop>
        <source src="assets/baby.mp3" type="audio/mpeg">
    </audio>

    <div id="mariposas-container"></div>

    <main class="invitation-wrapper">
        
        <section class="section">
            <div class="pdf-header" data-aos="zoom-in">
                <p class="big-subtitle">BABY</p>
                <p class="big-subtitle">Shower</p>
                <h1 class="main-name">Adelyne</h1>
                <p class="parents-text">Emily y Cristhian</p>
            </div>
        </section>

        <section class="section" data-aos="fade-up">
            <div class="glass-card">
                <p class="intro-text">Te invitamos al Baby Shower de nuestra hija el d√≠a:</p>
                
                <div class="date-row">
                    <div class="date-side">S√ÅBADO</div>
                    <div class="date-number">04</div>
                    <div class="date-side">ABRIL</div>
                </div>
                <p class="time-text">A LA 1:30 P.M.</p>

                <div class="action-box">
                    <p class="label-purple">DIRECCI√ìN DEL EVENTO</p>
                    <a href="https://maps.app.goo.gl/tu-link-real" target="_blank" class="btn-pdf">CLICK</a>
                </div>
            </div>
        </section>

        <section class="section" data-aos="fade-up">
            <div class="glass-card">
                <h3 class="font-cursive" style="font-size: 4em; margin-bottom: 20px;">¬øCu√°nto falta?</h3>
                
                <div id="countdown" class="timer-grid">
                    <div class="t-unit"><span id="days">00</span><small>D√çAS</small></div>
                    <div class="t-unit"><span id="hours">00</span><small>HORAS</small></div>
                    <div class="t-unit"><span id="mins">00</span><small>MINS</small></div>
                    <div class="t-unit"><span id="secs">00</span><small>SEG</small></div>
                </div>

                <div class="regalos-box" id="contenedor-regalos">
                    <h3 class="font-cursive" style="font-size: 3.5em;">Lista de Regalos</h3>
                    <p class="label-purple">Elige un detalle para Adelyne:</p>
                    
                    <form onsubmit="apartarRegalo(event)" id="form-regalos">
                        <input type="text" id="nombre-invitado" placeholder="Escribe tu nombre" required class="input-form">
                        
                        <select id="lista-regalos" required class="input-form">
                            <option value="">Cargando lista...</option>
                        </select>
                        
                        <button type="submit" id="btn-apartar" class="btn-pdf">ELEGIR REGALO</button>
                    </form>
                </div> 

                <div class="action-box" style="margin-top: 30px;">
                    <p class="label-purple" style="margin-top: 40px;">No olvides confirmar tu asistencia</p>
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSdb2igQYaiqrjoHKbn3LUXoNCz5vn9eiX-cBwVypz9tb_Atkw/viewform" target="_blank" class="btn-pdf">CLICK</a>
                </div>

                <h2 class="font-cursive" style="font-size: 4em; margin-top: 50px; color: #8e24aa;">¬°Te esperamos!</h2>
            </div>
        </section>
    </main>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({ duration: 1000 });

        // URL DE TU SCRIPT DE GOOGLE
        const URL_SCRIPT = "https://script.google.com/macros/s/AKfycbzfIogufitKgkioP7it1nKPsE8ihuPW4Lei3CyeEUMqWcpryDbpMIqbzb8AHsGGk-XDtg/exec";

        // Funci√≥n para abrir la invitaci√≥n
        function abrirInvitacion() {
            const audio = document.getElementById('musica-bebe');
            const overlay = document.getElementById('overlay');
            if (audio) { audio.play().catch(e => console.log("Audio esperando interacci√≥n")); }
            overlay.style.opacity = '0';
            setTimeout(() => { overlay.style.display = 'none'; }, 600);
        }

        // FUNCI√ìN PARA CARGAR REGALOS DESDE SHEETS
        async function obtenerRegalos() {
            try {
                const res = await fetch(URL_SCRIPT);
                const regalos = await res.json();
                const select = document.getElementById('lista-regalos');
                select.innerHTML = '<option value="">-- Selecciona un regalo --</option>';
                regalos.forEach(r => {
                    let opt = document.createElement('option');
                    opt.value = r; opt.textContent = r;
                    select.appendChild(opt);
                });
            } catch (e) {
                console.error("Error:", e);
                document.getElementById('lista-regalos').innerHTML = '<option>Error al cargar lista</option>';
            }
        }

        // FUNCI√ìN PARA APARTAR EL REGALO
        async function apartarRegalo(event) {
            event.preventDefault();
            const btn = document.getElementById('btn-apartar');
            const nombre = document.getElementById('nombre-invitado').value;
            const regalo = document.getElementById('lista-regalos').value;

            btn.innerText = "Procesando...";
            btn.disabled = true;

            try {
                const response = await fetch(URL_SCRIPT, {
                    method: 'POST',
                    body: JSON.stringify({ nombre: nombre, regalo: regalo })
                });
                const data = await response.json();

                if (data.result === "success") {
                    alert("¬°Gracias " + nombre + "! Has elegido: " + regalo);
                    document.getElementById('contenedor-regalos').innerHTML = "<h2 class='font-cursive' style='font-size:3em; color:#8e24aa;'>¬°Gracias por tu detalle!</h2>";
                } else {
                    alert(data.message);
                    obtenerRegalos(); 
                }
            } catch (e) {
                alert("Hubo un error al conectar. Intenta de nuevo.");
            } finally {
                btn.innerText = "ELEGIR REGALO";
                btn.disabled = false;
            }
        }

        // Generador de mariposas
        function crearMariposa() {
            const container = document.getElementById('mariposas-container');
            if(!container) return;
            const m = document.createElement('div');
            m.className = 'mariposa-vuelo';
            m.style.left = Math.random() * 100 + 'vw';
            m.style.animationDuration = (Math.random() * 3 + 5) + 's';
            container.appendChild(m);
            setTimeout(() => m.remove(), 8000);
        }
        setInterval(crearMariposa, 1000);

        // L√≥gica del contador
        const fechaEvento = new Date('April 4, 2026 13:30:00').getTime();
        setInterval(() => {
            const ahora = new Date().getTime();
            const d = fechaEvento - ahora;
            document.getElementById('days').innerText = Math.floor(d / (1000*60*60*24));
            document.getElementById('hours').innerText = Math.floor((d % (1000*60*60*24)) / (1000*60*60));
            document.getElementById('mins').innerText = Math.floor((d % (1000*60*60)) / (1000*60));
            document.getElementById('secs').innerText = Math.floor((d % (1000*60)) / 1000);
        }, 1000);

        // Cargar los regalos autom√°ticamente al abrir
        window.onload = obtenerRegalos;
    </script>
</body>
</html>